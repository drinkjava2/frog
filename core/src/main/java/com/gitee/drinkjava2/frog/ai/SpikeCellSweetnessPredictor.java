package com.gitee.drinkjava2.frog.ai;
 

import java.util.Arrays;
/*
 ä»¥ä¸Šå‡ ä¸ªä¾‹å­éƒ½å¤ªå¤æ‚ï¼Œè¯·æ”¹æˆç”¨ç®€å•çš„å‡ ä¸ªç»†èƒå¹¶é€šè¿‡è„‰å†²ä¿¡å·ä¼ é€’èƒ½é‡çš„æ–¹å¼æ¥å®ç°åŒæ ·çš„è¦æ±‚ï¼Œå¹¶ç»™å‡ºæºç 
 
(ä»¥ä¸‹ä¸ºGoogle Geminiç”Ÿæˆå†…å®¹)

è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æƒ³æ³•ï¼ä½¿ç”¨è„‰å†²ä¿¡å·ï¼ˆSpike Signalsï¼‰å’Œç»†èƒæ¿€æ´»æ¥æ¨¡æ‹Ÿç”Ÿç‰©ç³»ç»Ÿä¸­çš„ä¿¡æ¯ä¼ é€’ï¼Œå¯ä»¥æ›´ç›´è§‚åœ°ä½“ç°â€œå­¦ä¹ â€è¿‡ç¨‹ï¼Œå¹¶ä¸”é¿å…å¤æ‚çš„çŸ©é˜µè¿ç®—å’Œåå‘ä¼ æ’­ã€‚

æˆ‘ä»¬å°†é‡‡ç”¨ä¸€ä¸ªéå¸¸ç®€åŒ–çš„è„‰å†²ç¥ç»å…ƒæ¨¡å‹ï¼ˆä¹Ÿç§°ä¸ºç§¯åˆ†ä¸æ¿€å‘ Integrate-and-Fire æ¨¡å‹çš„æ¦‚å¿µç®€åŒ–ç‰ˆï¼‰ï¼Œç”¨ç»†èƒä¹‹é—´çš„çªè§¦æƒé‡æ¥ä»£è¡¨å­¦ä¹ åˆ°çš„å…³è”ã€‚
ğŸŒŸ ç®€åŒ–è„‰å†²ç»†èƒæ¨¡å‹è®¾è®¡

    ç»†èƒç±»å‹:

        è¾“å…¥ç»†èƒ (è§†è§‰): P1â€‹,P2â€‹ (åƒç´  1, åƒç´  2)

        ä¸­é—´ç»†èƒ (è”æƒ³): H1â€‹ (ä¸€ä¸ªéšè—ç¥ç»å…ƒï¼Œç”¨äºå°† P1â€‹,P2â€‹ çš„ç»„åˆæ˜ å°„åˆ°è¾“å‡º)

        è¾“å‡ºç»†èƒ (æ„Ÿå®˜): S (ç”œåº¦ç»†èƒ)

    ä¿¡å·/èƒ½é‡: ä½¿ç”¨æ•´æ•°å€¼æ¥è¡¨ç¤ºç»†èƒçš„æ´»æ€§æˆ–çªè§¦ä¼ é€’çš„â€œèƒ½é‡â€ã€‚å½“ç»†èƒçš„ç´¯ç§¯èƒ½é‡è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ªè„‰å†²ï¼ˆå³æ¿€æ´»ï¼‰ã€‚

    å­¦ä¹ æ–¹å¼ï¼ˆéåå‘ä¼ æ’­ï¼‰: æˆ‘ä»¬é‡‡ç”¨ä¸€ä¸ªç®€å•çš„ã€Hebb å­¦ä¹ è§„åˆ™çš„å˜ä½“ï¼šå¦‚æœè¾“å…¥ç»†èƒå’Œè¾“å‡ºç»†èƒåŒæ—¶æ¿€æ´»ï¼Œåˆ™åŠ å¼ºå®ƒä»¬ä¹‹é—´çš„è¿æ¥ï¼ˆçªè§¦æƒé‡å¢åŠ ï¼‰ã€‚

ğŸ’» Java è„‰å†²ç»†èƒæ¨¡å‹ä»£ç å®ç°

æˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ 10 ä»£è¡¨ç”œé£Ÿ (S æ¿€æ´») å’Œ 11 ä»£è¡¨è‹¦é£Ÿ (S ä¸æ¿€æ´»/è¢«æŠ‘åˆ¶)ã€‚ 
 * 
 * */

/**
 * ä½¿ç”¨ç®€åŒ–çš„â€œç§¯åˆ†ä¸æ¿€å‘â€ï¼ˆIntegrate-and-Fireï¼‰ç»†èƒæ¨¡å‹å’Œè„‰å†²ä¿¡å·ï¼Œ
 * é€šè¿‡ Hebbian å­¦ä¹ è§„åˆ™çš„å˜ä½“ï¼Œå®ç°è§†è§‰åˆ°ç”œåº¦çš„è”æƒ³è®°å¿†ã€‚
 */
public class SpikeCellSweetnessPredictor {

    // --- ç»†èƒå’Œè„‰å†²å‚æ•° ---
    private static final int THRESHOLD = 10;     // ç»†èƒæ¿€æ´»é˜ˆå€¼
    private static final int LEARNING_RATE = 5;  // å­¦ä¹ æ­¥é•¿ï¼ˆHebbè§„åˆ™ä¸­çš„å¢å¼ºé‡ï¼‰
    private static final int MAX_WEIGHT = 20;    // çªè§¦æƒé‡çš„ä¸Šé™
    private static final int EPOCHS = 50;        // è¯•åƒæ¬¡æ•° (å­¦ä¹ è½®æ¬¡)

    // --- çªè§¦æƒé‡ï¼ˆä»£è¡¨ç»†èƒé—´çš„è¿æ¥å¼ºåº¦/å­¦ä¹ ç»“æœï¼‰---
    // W_H_S[0]: P1 -> H1 çš„æƒé‡ (åœ¨æ­¤ç®€åŒ–æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥è®© P1, P2 è¿æ¥åˆ° S)
    // ä¸ºäº†ç®€åŒ–åˆ°æè‡´ï¼Œæˆ‘ä»¬ç›´æ¥å°†è¾“å…¥ç»†èƒè¿æ¥åˆ°è¾“å‡ºç»†èƒ Sã€‚
    // Weights[0]: P1 -> S æƒé‡
    // Weights[1]: P2 -> S æƒé‡
    private int[] weights = new int[2]; // åˆå§‹åŒ–ä¸º 0

    // --- è®­ç»ƒæ•°æ® (è§†è§‰æ¨¡å¼) ---
    // æ¨¡å¼ 10 (ç”œé£Ÿ S=1) å’Œ 11 (è‹¦é£Ÿ S=0)
    private static final int[][] TRAINING_DATA = {
        // P1, P2, ç›®æ ‡S (1=ç”œ, 0=è‹¦)
        {1, 0, 1}, // æ¨¡å¼ 10 -> ç”œ
        {1, 1, 0}, // æ¨¡å¼ 11 -> è‹¦
        {0, 0, 0}, // æ¨¡å¼ 00 -> è‹¦
        {0, 1, 0}  // æ¨¡å¼ 01 -> è‹¦
    };

    /**
     * ç»†èƒå­¦ä¹ è¿‡ç¨‹ (æ¨¡æ‹Ÿè¯•åƒå’Œçªè§¦åŠ å¼º)ã€‚
     */
    public void train() {
        System.out.println("--- å¼€å§‹è„‰å†²ç»†èƒå­¦ä¹  (è¯•åƒ) ---");
        
        for (int epoch = 0; epoch < EPOCHS; epoch++) {
            // æ¯æ¬¡è¯•åƒéƒ½éå†æ‰€æœ‰é£Ÿç‰©æ¨¡å¼
            for (int[] trial : TRAINING_DATA) {
                int p1 = trial[0];
                int p2 = trial[1];
                int target_s = trial[2];

                // 1. å‰å‘è„‰å†²ä¼ é€’ (è®¡ç®— S ç»†èƒçš„å‡€è¾“å…¥)
                // å‡€è¾“å…¥ = P1*W[0] + P2*W[1]
                int net_input = p1 * weights[0] + p2 * weights[1];
                
                // 2. Hebbian å­¦ä¹ è§„åˆ™çš„ç®€åŒ–å˜ä½“ (çªè§¦å¯å¡‘æ€§)
                // åªæœ‰å½“è¾“å…¥ Px æ¿€æ´» (1) ä¸”ç›®æ ‡ S æ¿€æ´» (1) æ—¶ï¼ŒåŠ å¼ºè¿æ¥ã€‚
                // å¦‚æœ Px æ¿€æ´» (1) ä½†ç›®æ ‡ S è¢«æŠ‘åˆ¶ (0)ï¼Œåˆ™å‰Šå¼±è¿æ¥ã€‚
                
                // å¤„ç† P1 -> S çš„è¿æ¥
                if (p1 == 1) {
                    if (target_s == 1) {
                        // ç”œé£Ÿ (10) å‡ºç°ï¼ŒP1 æ¿€æ´»ï¼ŒåŠ å¼º P1 -> S
                        weights[0] += LEARNING_RATE;
                    } else {
                        // è‹¦é£Ÿ (11) å‡ºç°ï¼ŒP1 æ¿€æ´»ï¼Œå‰Šå¼± P1 -> S
                        weights[0] -= LEARNING_RATE;
                    }
                }
                
                // å¤„ç† P2 -> S çš„è¿æ¥
                if (p2 == 1) {
                    if (target_s == 1) {
                        // ç”œé£Ÿ (10) å‡ºç°ï¼ŒP2 æ¿€æ´» (æ­¤æ—¶ P2=0, ä¸ä¼šå‘ç”Ÿ)
                        weights[1] += LEARNING_RATE;
                    } else {
                        // è‹¦é£Ÿ (11/01) å‡ºç°ï¼ŒP2 æ¿€æ´»ï¼Œå‰Šå¼± P2 -> S
                        weights[1] -= LEARNING_RATE;
                    }
                }

                // 3. é™åˆ¶æƒé‡ï¼Œé˜²æ­¢æ— é™å¢é•¿
                for (int i = 0; i < weights.length; i++) {
                    weights[i] = Math.min(Math.max(weights[i], -MAX_WEIGHT), MAX_WEIGHT);
                }
            }
            
            if (epoch % 10 == 0) {
                 System.out.printf("Epoch %d: å½“å‰æƒé‡ W(P1->S)=%d, W(P2->S)=%d%n", 
                                   epoch, weights[0], weights[1]);
            }
        }
        System.out.println("--- å­¦ä¹ ç»“æŸï¼Œæœ€ç»ˆæƒé‡: " + Arrays.toString(weights) + " ---");
    }

    /**
     * é¢„æµ‹ï¼šæ ¹æ®è§†è§‰è„‰å†²ï¼Œè®¡ç®— S ç»†èƒæ˜¯å¦æ¿€æ´»ã€‚
     * @param p1 åƒç´  1 è„‰å†² (0/1)
     * @param p2 åƒç´  2 è„‰å†² (0/1)
     * @return é¢„æµ‹çš„ç”œåº¦è„‰å†² (1=ç”œ, 0=è‹¦)
     */
    public int predictSweetness(int p1, int p2) {
        // 1. ç»†èƒæ¥æ”¶è„‰å†²å¹¶ç§¯åˆ†
        int net_input = p1 * weights[0] + p2 * weights[1];

        // 2. æ£€æŸ¥å‡€è¾“å…¥æ˜¯å¦è¶…è¿‡é˜ˆå€¼ (æ¿€å‘)
        if (net_input >= THRESHOLD) {
            return 1; // S ç»†èƒæ¿€æ´»ï¼Œå‘é€ç”œåº¦è„‰å†²
        } else {
            return 0; // S ç»†èƒæœªæ¿€æ´»ï¼Œå‘é€æ— ç”œåº¦è„‰å†² (è‹¦)
        }
    }

    public static void main(String[] args) {
        SpikeCellSweetnessPredictor model = new SpikeCellSweetnessPredictor();
        
        // å­¦ä¹ è¿‡ç¨‹ (è¯•åƒå‡ æ¬¡)
        model.train();

        System.out.println("\n--- é¢„æµ‹ç»“æœï¼ˆæ— éœ€æ„Ÿå®˜ç»†èƒå‚ä¸ï¼‰ ---");
        System.out.printf("S ç»†èƒæ¿€æ´»é˜ˆå€¼: %d%n", THRESHOLD);

        // 1. æµ‹è¯•æ¨¡å¼ 10 (ç›®æ ‡: ç”œ)
        int p1_10 = 1, p2_10 = 0;
        int prediction10 = model.predictSweetness(p1_10, p2_10);
        String status10 = (prediction10 == 1) ? "ç”œ (Sæ¿€æ´»)" : "è‹¦ (Sæœªæ¿€æ´»)";
        System.out.printf("è§†è§‰è„‰å†² 10: P1*W[0] + P2*W[1] = %d | é¢„æµ‹: %s%n", 
                          p1_10 * model.weights[0] + p2_10 * model.weights[1], status10);

        // 2. æµ‹è¯•æ¨¡å¼ 11 (ç›®æ ‡: è‹¦)
        int p1_11 = 1, p2_11 = 1;
        int prediction11 = model.predictSweetness(p1_11, p2_11);
        String status11 = (prediction11 == 1) ? "ç”œ (Sæ¿€æ´»)" : "è‹¦ (Sæœªæ¿€æ´»)";
        System.out.printf("è§†è§‰è„‰å†² 11: P1*W[0] + P2*W[1] = %d | é¢„æµ‹: %s%n", 
                          p1_11 * model.weights[0] + p2_11 * model.weights[1], status11);

        // 3. æµ‹è¯•æ¨¡å¼ 00 (ç›®æ ‡: è‹¦)
        int p1_00 = 0, p2_00 = 0;
        int prediction00 = model.predictSweetness(p1_00, p2_00);
        String status00 = (prediction00 == 1) ? "ç”œ (Sæ¿€æ´»)" : "è‹¦ (Sæœªæ¿€æ´»)";
        System.out.printf("è§†è§‰è„‰å†² 00: P1*W[0] + P2*W[1] = %d | é¢„æµ‹: %s%n", 
                          p1_00 * model.weights[0] + p2_00 * model.weights[1], status00);
    }
}